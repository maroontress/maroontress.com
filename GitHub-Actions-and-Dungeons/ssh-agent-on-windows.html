<!DOCTYPE html>
<html lang="ja">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZTJ8C5812"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-0ZTJ8C5812');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4691079535294206" crossorigin="anonymous"></script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Attemp #1 Windowsãƒ©ãƒ³ãƒŠãƒ¼ã§ssh-agent | GitHub Actions and Dungeons</title>
    <link rel="canonical" href="https://www.maroontress.com/GitHub-Actions-and-Dungeons/ssh-agent-on-windows.html" />
    <link rel="stylesheet" type="text/css" href="/css/markdown.ja.css">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/logo-v2-120x120.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/logo-v2-180x180.png">
    <link rel="icon" type="image/x-icon" href="/images/logo-v2.ico">
    <link rel="mask-icon" href="/images/logo-v2-mask-icon.svg" color="#800000">
    <script src="/js/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="/js/toc.js"></script>
  </head>
  <body>
    <div class="logo">
      <b>Maroontress Fast Software</b>
    </div>
    <div class="container">
      <div class="main-container">
        <section>
          <main class="content">
<div class="project-logo">GitHub Actions and Dungeons</div>
<div id="toc-level" data-values="H2,H3"></div>
<h1>Attempt #1<br>Windowsãƒ©ãƒ³ãƒŠãƒ¼ã§ssh-agent</h1>
<p>Windowsãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã†äºˆå®šã®ãªã„äººã¯ã€ä»¥é™ã¾ã£ãŸãèª­ã‚€ä¾¡å€¤ãŒç„¡ã„ã“ã¨ã«æ³¨æ„ã€‚</p>
<h2>åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³</h2>
<p>ã‚ã‚‹ãƒªãƒã‚¸ãƒˆãƒªAã«ã¤ã„ã¦GitHub Actionsã®ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œä¸­ã«ã€Aã¨åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªBã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã¾ãŸã¯ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¨˜è¿°ã—ãŸã„ã€‚Windowsãƒ©ãƒ³ãƒŠãƒ¼ã«é™ã‚‰ãªã„ãŒã€ç°¡å˜ãªæ–¹æ³•ã¯ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®actions/checkoutã‚’æ¬¡ã®ã‚ˆã†ã«ä½¿ã†ã“ã¨ã ã‚ã†:</p>
<pre><code class="language-yaml">    steps:
    - name: Checkout private repository
      uses: actions/checkout@v4
      with:
        repository: maroontress-tomohisa/private-repository-example
        ssh-key: ${{secrets.PRIVATE_REPO_DEPLOY_KEY}}
        path: private-repository-example
    - name: Print README.md
      shell: bash
      run: |
        cat private-repository-example/README.md
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L13-L23">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>ã€Œãƒªãƒã‚¸ãƒˆãƒªBã€ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã€<a href="https://docs.github.com/ja/authentication/connecting-to-github-with-ssh/managing-deploy-keys#deploy-keys">ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼</a>ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã™ã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªBã®URLã¯<code>git@github.com:maroontress-tomohisa/private-repository-example.git</code>ã¨ã—ã‚ˆã†ã€‚ãã—ã¦ã€ãƒªãƒã‚¸ãƒˆãƒªBã«ã¯é©åˆ‡ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã€ãƒªãƒã‚¸ãƒˆãƒªAã®<a href="https://docs.github.com/ja/actions/security-guides/using-secrets-in-github-actions#about-secrets">ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ</a>ã«é©åˆ‡ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¦ã€ãã‚Œã‚’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã§ã¯<code>secret.PRIVATE_REPO_DEPLOY_KEY</code>ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€ã¨ã™ã‚‹ã€‚</p>
<p>æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒªãƒã‚¸ãƒˆãƒªBã‚’<code>private-repository-example</code>ã«ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ã€‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ç¢ºèªã®ãŸã‚ã€ãƒªãƒã‚¸ãƒˆãƒªBã®<code>README.md</code>ã‚’å‡ºåŠ›ã™ã‚‹ã€‚</p>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Run actions/checkout@v4
Syncing repository: maroontress-tomohisa/private-repository-example
Getting Git version info

Temporarily overriding HOME='D:\a\_temp\d3f120f5-cde6-43a2-b847-7146107be8b8' before making global git config changes
Adding repository directory to the temporary git global config as a safe directory
&quot;C:\Program Files\Git\bin\git.exe&quot; config --global --add safe.directory D:\a\try_out_github_actions\try_out_github_actions\private-repository-example
Initializing the repository
Disabling automatic garbage collection
Setting up auth
Determining the default branch
Fetching the repository
Determining the checkout info
Checking out the ref
&quot;C:\Program Files\Git\bin\git.exe&quot; log -1 --format='%H'
'3cf9492e7ffb20ea5246a8edf1bec8d3aab293a4'
â‹®
# An Example of Private Repository
</code></pre>
<blockquote>
<p><a href="attempt1/result-1.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>æˆåŠŸã ã€‚æœ€å¾Œã®è¡Œã¯<code>README.md</code>ã®ä¸­èº«ãã®ã‚‚ã®ã§ã‚ã‚‹ã€‚</p>
<p>ã“ã®ã‚ˆã†ã«ã€actions/checkoutã‚’ä½¿ãˆã°ã€åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã—ã‹ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚‚åŒã˜ã‚ˆã†ã«ãƒªãƒã‚¸ãƒˆãƒªBã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€ä½•ã‚‰ã‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”¨æ„ã—ã¦ã€ãã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ãŸã„ã€‚ãã†ã™ã‚‹ã¨ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ãŸã‚‚ã®ã¯GitHub Actionsã§ã—ã‹å®Ÿè¡Œã§ããªã„ã®ã§ã€äºŒé‡ã«ç®¡ç†ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«å¤‰æ›ã™ã‚‹ä½•ã‹ã‚’ä½œã‚‹ã®ã‚‚è‰¯ã•ãã†ã ãŒã€ä»–ã®æ–¹æ³•ã‚‚èª¿ã¹ã¦ã¿ã‚ˆã†ã€‚</p>
<h2>ssh-agentã§åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³</h2>
<p>åŒã˜ã“ã¨ã‚’ã€ä»Šåº¦ã¯<code>ssh-agent</code>ã‚’ç”¨ã„ã¦ã‚„ã£ã¦ã¿ã‚‹ã€‚ãã†ã§ã¯ãªãã€<code>~/.ssh/config</code>ã«ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ã‚‚ã§ãã‚‹ãŒã€ãã‚Œã¯å¾Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è©¦ã—ã¦ã¿ã‚‹ã€‚</p>
<p>ã¾ãšã€Windowsãƒ©ãƒ³ãƒŠãƒ¼ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹<code>ssh-agent</code>é–¢é€£ã®ã‚³ãƒãƒ³ãƒ‰ãŒã©ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã‹ã‚’ç¢ºèªã™ã‚‹ã€‚</p>
<pre><code class="language-yaml">    - name: Check commands
      shell: bash
      run: |
        ls -l `which ssh`
        ls -l `which ssh-add`
        ls -l `which ssh-agent`
        ls -l `which git`
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L29-L35">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">-rwxr-xr-x 1 runneradmin 197121 958822 Aug 30 09:46 /usr/bin/ssh
-rwxr-xr-x 1 runneradmin 197121 441485 Aug 30 09:46 /usr/bin/ssh-add
-rwxr-xr-x 1 runneradmin 197121 415546 Aug 30 09:46 /usr/bin/ssh-agent
-rwxr-xr-x 4 runneradmin 197121 3830264 Aug 30 09:49 /mingw64/bin/git
</code></pre>
<blockquote>
<p><a href="attempt1/result-2.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>Windowsã®<code>ssh-agent</code>ã®å®Ÿè£…ã¯ã„ãã¤ã‹ã‚ã‚‹ãŒã€ãƒ‘ã‚¹ã«ã‚ã‚‹ã®ã¯Git for Windowsã®ã‚‚ã®ã§ã‚ã‚‹ã€‚</p>
<p><code>ssh-agent</code>ã‚’ç´ ç›´ã«å®Ÿè¡Œã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹:</p>
<pre><code class="language-yaml">    - name: Start ssh-agent
      shell: bash
      run: |
        eval `ssh-agent`
        echo SSH_AUTH_SOCK=&quot;$SSH_AUTH_SOCK&quot; &gt;&gt; &quot;$GITHUB_ENV&quot;
        echo SSH_AGENT_PID=&quot;$SSH_AGENT_PID&quot; &gt;&gt; &quot;$GITHUB_ENV&quot;
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L36-L41">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>æœ€å¾Œã®äºŒè¡Œã¯ã€å¾Œã«ç¶šãã‚¹ãƒ†ãƒƒãƒ—ã§ç’°å¢ƒå¤‰æ•°<code>SSH_AUTH_SOCK</code>ã¨<code>SSH_AGENT_PID</code>ãŒæœ‰åŠ¹ã«ãªã‚‹ã‚ˆã†ã«<code>$GITHUB_ENV</code>ã«è¿½è¨˜ã—ã¦ã„ã‚‹ï¼ˆè©³ç´°ã¯<a href="https://docs.github.com/ja/actions/using-workflows/workflow-commands-for-github-actions#setting-an-environment-variable">ç’°å¢ƒå¤‰æ•°ã®è¨­å®š</a>ã‚’å‚ç…§ï¼‰ã€‚</p>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Agent pid 433
</code></pre>
<blockquote>
<p><a href="attempt1/result-3.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>ssh-agent</code>ãŒãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ä½œã—ãŸã®ã§ã€æ¬¡ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’<code>ssh-add</code>ã‚³ãƒãƒ³ãƒ‰ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ç™»éŒ²ã™ã‚‹:</p>
<pre><code class="language-yaml">    - name: Add a deploy key
      shell: bash
      run: |
        mkdir -p $HOME/.ssh
        echo &quot;${{secrets.PRIVATE_REPO_DEPLOY_KEY}}&quot; &gt; $HOME/.ssh/PRIVATE_REPO_DEPLOY_KEY
        ssh-add $HOME/.ssh/PRIVATE_REPO_DEPLOY_KEY
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L42-L47">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>ä¸€æ—¦ã€<code>~/.ssh</code>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ã€ãã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã‚’ä¿å­˜ã—ãŸã€‚</p>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Identity added: /c/Users/runneradmin/.ssh/PRIVATE_REPO_DEPLOY_KEY (git@github.com:maroontress-tomohisa/private-repository-example.git)
</code></pre>
<blockquote>
<p><a href="attempt1/result-4.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ç„¡äº‹ã€ç™»éŒ²ã§ããŸã€‚ã‚«ãƒƒã‚³å†…ã«SSHã‚­ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆã«ãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŒ‡å®šã—ã¦ä½œæˆã—ãŸã€‚ã“ã‚Œã¯ç¾æ™‚ç‚¹ã§ã¯æ„å‘³ãŒç„¡ã„ï¼ˆå¾Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€è¤‡æ•°ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’èª­ã¿å‡ºã™ã¨ãã«ç”¨ã„ã‚‹ï¼‰ã®ã§ã€ã“ã“ã§ã¯ç„¡è¦–ã™ã‚‹ã€‚</p>
<p>å¿µã®ãŸã‚ã€æ¬¡ã®ã‚ˆã†ã«<code>ssh-add -l</code>ã§ç™»éŒ²ã•ã‚ŒãŸã‚­ãƒ¼ã‚’ç¢ºèªã™ã‚‹:</p>
<pre><code class="language-yaml">    - name: List fingerprints
      shell: bash
      run: |
        ssh-add -l
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L48-L51">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">3072 SHA256:EHYsJhMvV2X03sbEYcAH3w7MNft1lra8M/ZSF0XMr5k git@github.com:maroontress-tomohisa/private-repository-example.git (RSA)
</code></pre>
<blockquote>
<p><a href="attempt1/result-5.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ã“ã‚Œã§<code>git clone</code>ã§ãã‚‹ã¯ãšã§ã‚ã‚‹ã€‚æ¬¡ã®ã‚ˆã†ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Clone the private repository (which fails)
      continue-on-error: true
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-repository-example.git
        cat private-repository-example/README.md
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L52-L57">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>æœ€å¾Œã®è¡Œã¯ã€ã‚¯ãƒ­ãƒ¼ãƒ³ã«æˆåŠŸã—ãŸå ´åˆã«<code>README.md</code>ã‚’è¡¨ç¤ºã—ãŸã„ã€ã¨ã„ã†æ„å›³ã ãŒã€æˆåŠŸã—ãªã„ã®ã§æ„å‘³ãŒç„¡ã„ã€‚çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Cloning into 'private-repository-example'...
Host key verification failed.
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
Error: Process completed with exit code 128.
</code></pre>
<blockquote>
<p><a href="attempt1/result-6.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ã“ã‚Œã¯ç°¡å˜ã§ã€<code>github.com</code>ã®SSHãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚­ãƒ¼ãŒ<code>~/.ssh/known_hosts</code>ã«å«ã¾ã‚Œã¦ãªã„ã®ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚ãã‚‚ãã‚‚<code>~/.ssh/known_hosts</code>ãŒå­˜åœ¨ã—ã¦ãªã„ã®ã ã€‚æ¬¡ã®ã‚ˆã†ã«<code>known_hosts</code>ã‚’ä½œæˆã—ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Perform workarounds (create ~/.ssh/known_hosts)
      shell: bash
      run: |
        rm -rf private-repository-example
        cat &lt;&lt; EOF &gt; $HOME/.ssh/known_hosts
        github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
        EOF
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L58-L64">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>ã‚‚ã†ä¸€åº¦ã€æ¬¡ã®ã‚ˆã†ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Clone a private repository
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-repository-example.git
        cat private-repository-example/README.md
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L65-L69">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Cloning into 'private-repository-example'...
# An Example of Private Repository
</code></pre>
<blockquote>
<p><a href="attempt1/result-7.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>æˆåŠŸã—ãŸã€‚</p>
<blockquote>
<p><span style="font-size: large;">â˜•</a></p>
<p>å°‘ã—å‰ã¾ã§ã¯ã€ã“ã®æ®µéšã§ç’°å¢ƒå¤‰æ•°<code>GIT_SSH</code>ã®è¨­å®šãŒå¿…è¦ã ã£ãŸã®ã ãŒã€ç¾åœ¨ã¯ãã®å¿…è¦ãŒç„¡ããªã£ãŸã€‚GitHub Actionsã®ä¸–ç•Œã¯å°‘ã—ãšã¤è‰¯ããªã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚</p>
</blockquote>
<h2>åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆLFSãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³</h2>
<p>ä»Šåº¦ã¯ã€åˆ¥ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªCã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†ã€‚ãŸã ã—ã€ãƒªãƒã‚¸ãƒˆãƒªCã¯Git LFSã‚’ç”¨ã„ã¦ã„ã‚‹ã€‚ãã†ã€èª¬æ˜ã¯ãªã‹ã£ãŸãŒã€å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒªãƒã‚¸ãƒˆãƒªBã¯LFSã‚’ä½¿ã£ã¦ã„ãªã‹ã£ãŸã€‚</p>
<p>ãƒªãƒã‚¸ãƒˆãƒªCã®URLã¯<code>git@github.com:maroontress-tomohisa/private-lfs-repository-example.git</code>ã¨ã™ã‚‹ã€‚ä»Šåº¦ã‚‚åŒæ§˜ã«ã€ãƒªãƒã‚¸ãƒˆãƒªCã«ã¯é©åˆ‡ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã€ãƒªãƒã‚¸ãƒˆãƒªAã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«é©åˆ‡ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¦ã€ãã‚Œã‚’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã§ã¯<code>secret.PRIVATE_LFS_REPO_DEPLOY_KEY</code>ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã¨ã—ã‚ˆã†ã€‚</p>
<p>ç´ ç›´ã«è€ƒãˆã‚‹ã¨ã€å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨åŒã˜ã‚ˆã†ã«ã€URLã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®å¤‰æ•°ã ã‘å¤‰æ›´ã™ã‚Œã°ã§ããã†ã ã€‚æ¬¡ã®ã‚ˆã†ã«ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã™ã‚‹:</p>
<pre><code class="language-yaml">    steps:
    - name: Start ssh-agent
      shell: bash
      run: |
        mkdir -p $HOME/.ssh
        cat &lt;&lt; EOF &gt; $HOME/.ssh/known_hosts
        github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
        EOF
        eval `ssh-agent`
        echo SSH_AUTH_SOCK=&quot;$SSH_AUTH_SOCK&quot; &gt;&gt; &quot;$GITHUB_ENV&quot;
        echo SSH_AGENT_PID=&quot;$SSH_AGENT_PID&quot; &gt;&gt; &quot;$GITHUB_ENV&quot;
    - name: Add a deploy key
      shell: bash
      run: |
        echo &quot;${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}&quot; &gt; $HOME/.ssh/PRIVATE_LFS_REPO_DEPLOY_KEY
        ssh-add $HOME/.ssh/PRIVATE_LFS_REPO_DEPLOY_KEY
    - name: List fingerprints
      shell: bash
      run: |
        ssh-add -l
    - name: Clone a private repository with LFS
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
        cat private-lfs-repository-example/README.md
        unzip -v private-lfs-repository-example/empty.zip
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L74-L99">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªCã®ãƒ«ãƒ¼ãƒˆã«ã¯<code>empty.zip</code>ãŒã‚ã‚‹ã®ã§ã€æœ€å¾Œã®è¡Œã§ãã‚Œã‚’ç¢ºèªã§ãã‚Œã°æˆåŠŸã ã€‚çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Agent pid 56
â‹®
Identity added: /c/Users/runneradmin/.ssh/PRIVATE_LFS_REPO_DEPLOY_KEY (git@github.com:maroontress-tomohisa/private-lfs-repository-example.git)
â‹®
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
â‹®
Cloning into 'private-lfs-repository-example'...
# An Example of Private Repository with LFS
Archive:  private-lfs-repository-example/empty.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2023-10-06 06:44 00000000  empty
--------          -------  ---                            -------
       0                0   0%                            1 file
</code></pre>
<blockquote>
<p><a href="attempt1/result-8.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>æˆåŠŸã—ãŸã€‚</p>
<blockquote>
<p><span style="font-size: large;">â˜•</a></p>
<p>å°‘ã—å‰ã¾ã§ã¯ã€ã“ã®æ®µéšã§ã‚‚ç’°å¢ƒå¤‰æ•°<code>GIT_SSH</code>ã®è¨­å®šãŒå¿…è¦ã ã£ãŸã®ã ãŒã€ç¾åœ¨ã¯ãã®å¿…è¦ãŒç„¡ããªã£ãŸã€‚</p>
</blockquote>
<p>ãªãŠã€actions/checkoutã‚’ç”¨ã„ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³<code>lfs: true</code>ã®è¿½åŠ ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ã«æ³¨æ„:</p>
<pre><code class="language-yaml">    steps:
    - name: Checkout private LFS repository
      uses: actions/checkout@v4
      with:
        repository: maroontress-tomohisa/private-lfs-repository-example
        ssh-key: ${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}
        lfs: true
        path: private-lfs-repository-example
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L104-L116">GitHubã§è¦‹ã‚‹</a></p>
<p><a href="attempt1/result-9.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<h2>åˆ¥ã®è¤‡æ•°ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹</h2>
<p>æ¬¡ã«ã€äºŒã¤ã®ãƒªãƒã‚¸ãƒˆãƒªBã¨Cã‚’ã€ãƒªãƒã‚¸ãƒˆãƒªAã®ã‚¸ãƒ§ãƒ–ã‹ã‚‰èª­ã¿å‡ºã—ãŸã„ã€‚actions/checkoutã‚’ä½¿ã†ãªã‚‰äºŒã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ä¸¦ã¹ã‚Œã°è‰¯ã„ãŒã€<code>ssh-agent</code>ã‚’ä½¿ã£ã¦ã‚‚ã§ãã‚‹ã®ã ã‚ã†ã‹ã€‚</p>
<p><code>ssh-agent</code>ã«<code>ssh-add</code>ã§<strong>åŒã˜ãƒ›ã‚¹ãƒˆã®</strong>ã‚­ãƒ¼ã‚’è¤‡æ•°è¿½åŠ ã™ã‚‹ã“ã¨ã¯ã§ãã‚‹ã€‚ã—ã‹ã—ã€<code>ssh</code>ã¯ã€æ¥ç¶šã«å¤±æ•—ã—ãŸã‚‰æ¬¡ã®ã‚­ãƒ¼ã‚’è©¦ã™ã€ã®ã‚ˆã†ã«æ¥ç¶šå…ˆã«é †ç•ªã«ã‚­ãƒ¼ã‚’é©ç”¨ã™ã‚‹ã ã‘ã§ã‚ã‚‹ã€‚ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®webfactory/ssh-agentã®<a href="https://github.com/webfactory/ssh-agent#using-multiple-keys">èª¬æ˜</a>ã‚’å¼•ç”¨ã™ã‚‹ã¨:</p>
<blockquote>
<p>ãŸã ã—ã€æ³¨æ„ç‚¹ãŒ1ã¤ã‚ã‚Šã¾ã™ã€‚SSHã‚µãƒ¼ãƒãƒ¼ã¯ã€å¤šæ•°ã®ä¸€è‡´ã—ãªã„ã‚­ãƒ¼ãŒæç¤ºã•ã‚ŒãŸå¾Œã«æ¥ç¶šè©¦è¡Œã‚’ä¸­æ–­ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€ãŸã¨ãˆã°ã€6ã¤ã®ç•°ãªã‚‹ã‚­ãƒ¼ãŒssh-agentã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¦ã€5ã¤ã®ä¸æ˜ãªã‚­ãƒ¼ã®å¾Œã«ã‚µãƒ¼ãƒãƒ¼ãŒä¸­æ–­ã—ãŸå ´åˆã€æœ€å¾Œã®ã‚­ãƒ¼ï¼ˆæ­£ã—ã„ã‚­ãƒ¼ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼‰ã¯æ±ºã—ã¦è©¦ã•ã‚Œã¾ã›ã‚“ã€‚</p>
</blockquote>
<p>ã ã‹ã‚‰ã€<code>ssh-agent</code>ã‚’ç”¨ã„ã¦<strong>åŒã˜ãƒ›ã‚¹ãƒˆã®</strong>è¤‡æ•°ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ãªã‚‰ã€æ¬¡ã®ã‚ˆã†ã«ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®ç™»éŒ²ã€ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã®å‰Šé™¤ã€ã‚’ç¹°ã‚Šè¿”ã™å¿…è¦ãŒã‚ã‚‹:</p>
<ul>
<li>ãƒªãƒã‚¸ãƒˆãƒªBã®ã‚­ãƒ¼ã‚’<code>ssh-add</code>ã§ç™»éŒ²</li>
<li>ãƒªãƒã‚¸ãƒˆãƒªBã‚’ã‚¯ãƒ­ãƒ¼ãƒ³</li>
<li>ãƒªãƒã‚¸ãƒˆãƒªBã®ã‚­ãƒ¼ã‚’<code>ssh-add -d</code>ã§å‰Šé™¤</li>
<li>ãƒªãƒã‚¸ãƒˆãƒªCã®ã‚­ãƒ¼ã‚’<code>ssh-add</code>ã§ç™»éŒ²</li>
<li>ãƒªãƒã‚¸ãƒˆãƒªCã‚’ã‚¯ãƒ­ãƒ¼ãƒ³</li>
<li>ãƒªãƒã‚¸ãƒˆãƒªCã®ã‚­ãƒ¼ã‚’<code>ssh-add -d</code>ã§å‰Šé™¤</li>
<li>â‹®</li>
</ul>
<p>ã¨ã“ã‚ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹éš›ã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’ç”¨ã„ã‚‹ã“ã¨ãªãã€äºŒã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã§ãã‚‹ã®ãŒæœ›ã¾ã—ã„ã€‚ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã¨åŒã˜ã‚ˆã†ãªæ‰‹é †ã§ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ãŸã„ã®ã§ã€<code>ssh-agent</code>ã‚’ç”¨ã„ã‚‹ã®ã‚’ã‚„ã‚ã¦ã€åˆ¥ã®æ–¹æ³•ã‚’è©¦ã—ã¦ã¿ã‚ˆã†ã€‚</p>
<p>ãƒªãƒã‚¸ãƒˆãƒªBã¨Cã¯ã€åŒã˜ãƒ›ã‚¹ãƒˆ<code>github.com</code>ã«ã‚ã‚‹ã®ã§ã€ã¡ã‚‡ã£ã¨ã—ãŸå·¥å¤«ãŒå¿…è¦ã«ãªã‚‹ï¼ˆGitHub Actionsã«é™ã£ãŸè©±ã§ã¯ãªãã€è‰¯ãçŸ¥ã‚‰ã‚ŒãŸè©±ãªã®ã§ã€è©³ç´°ã¯ChatGPTã«ã§ã‚‚å°‹ã­ã¦ã»ã—ã„ï¼‰ã€‚è¦ç´„ã™ã‚‹ã¨ã€<code>git config</code>ã®<a href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-urlltbasegtinsteadOf"><code>url.&lt;base&gt;.insteadOf</code></a>ã®æ©Ÿèƒ½ã¨ã€<code>~/.ssh/config</code>ã®<code>Host</code>åŠã³<a href="https://man.openbsd.org/ssh_config#Hostname"><code>Hostname</code></a>ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã€Gitã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ãƒªãƒã‚¸ãƒˆãƒªæ¯ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå½ãƒ›ã‚¹ãƒˆåã‚’å‰²ã‚Šå½“ã¦ã€SSHã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å½ãƒ›ã‚¹ãƒˆåã‚’<code>github.com</code>ã«å¤‰æ›ã—ã€åŒæ™‚ã«ãã®å½ãƒ›ã‚¹ãƒˆã«å¯¾å¿œã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã®SSHã‚­ãƒ¼ã‚’é–¢é€£ä»˜ã‘ã‚‹ã€ã¨ã„ã†æŠ€æ³•ã§ã‚ã‚‹ã€‚å…·ä½“çš„ã«ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹:</p>
<pre><code class="language-yaml">    steps:
    - name: Create ~/.ssh/known_hosts
      shell: bash
      run: |
        mkdir -p $HOME/.ssh
        cat &lt;&lt; EOF &gt; $HOME/.ssh/known_hosts
        github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
        EOF
    - name: Add deploy keys
      shell: bash
      run: |
        add_key() {
          key=&quot;$HOME/.ssh/$1&quot;
          win_key=&quot;$(cygpath -w $key)&quot;
          echo &quot;$2&quot; &gt; &quot;$key&quot;
          ssh-keygen -y -f $key &gt; $key.pub
          read a b comment &lt; $key.pub
          echo comment: $comment
          url=&quot;${comment%.*}&quot;
          echo url: $url
          host_path=&quot;${url#*@}&quot;
          new_host_path=&quot;$1.${host_path}&quot;
          new_url=&quot;git@$new_host_path&quot;
          echo git config --global url.&quot;${new_url}&quot;.insteadOf &quot;${url}&quot;
          git config --global url.&quot;${new_url}&quot;.insteadOf &quot;${url}&quot;
          cat &lt;&lt; EOF &gt;&gt; $HOME/.ssh/config

        Host ${new_host_path%%:*}
          HostName github.com
          IdentityFile $win_key
          IdentitiesOnly yes
        EOF
        }
        add_key PRIVATE_REPO_DEPLOY_KEY &quot;${{secrets.PRIVATE_REPO_DEPLOY_KEY}}&quot;
        add_key PRIVATE_LFS_REPO_DEPLOY_KEY &quot;${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}&quot;
    - name: Print git config
      shell: bash
      run: git config --global --list
    - name: Print ssh config
      shell: bash
      run: cat $HOME/.ssh/config
    - name: Clone a private repository
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-repository-example.git
        cat private-repository-example/README.md
    - name: Clone another private repository with LFS
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
        cat private-lfs-repository-example/README.md
        unzip -v private-lfs-repository-example/empty.zip
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L121-L172">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>å°‘ã—é•·ã„ãŒã€ãã‚Œã»ã©é›£ã—ãã¯ãªã„ã€‚<code>Add deploy keys</code>ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã€<code>git config</code>ã«ã‚ˆã‚‹è¨­å®šå¤‰æ›´ã¨<code>~/.ssh/config</code>ã®ã‚¨ãƒ³ãƒˆãƒªä½œæˆã‚’ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã”ã¨ã«å®Ÿæ–½ã™ã‚‹ã€‚å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¨€åŠã—ãŸSSHã‚­ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯ã“ã“ã§ä½¿ç”¨ã™ã‚‹ã€‚éµã«ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦URLã‚’åŸ‹ã‚è¾¼ã‚“ã§ãŠãã“ã¨ã§ã€ã€Œã‚­ãƒ¼ã¨URLã€ã®çµ„ã¿ã‚’è¨˜è¿°ã›ãšã«æ¸ˆã‚“ã§ã„ã‚‹ã€‚çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">comment: git@github.com:maroontress-tomohisa/private-repository-example.git
url: git@github.com:maroontress-tomohisa/private-repository-example
git config --global url.git@PRIVATE_REPO_DEPLOY_KEY.github.com:maroontress-tomohisa/private-repository-example.insteadOf git@github.com:maroontress-tomohisa/private-repository-example
comment: git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
url: git@github.com:maroontress-tomohisa/private-lfs-repository-example
git config --global url.git@PRIVATE_LFS_REPO_DEPLOY_KEY.github.com:maroontress-tomohisa/private-lfs-repository-example.insteadOf git@github.com:maroontress-tomohisa/private-lfs-repository-example
â‹®
url.git@PRIVATE_REPO_DEPLOY_KEY.github.com:maroontress-tomohisa/private-repository-example.insteadof=git@github.com:maroontress-tomohisa/private-repository-example
url.git@PRIVATE_LFS_REPO_DEPLOY_KEY.github.com:maroontress-tomohisa/private-lfs-repository-example.insteadof=git@github.com:maroontress-tomohisa/private-lfs-repository-example
â‹®

Host PRIVATE_REPO_DEPLOY_KEY.github.com
  HostName github.com
  IdentityFile C:\Users\runneradmin\.ssh\PRIVATE_REPO_DEPLOY_KEY
  IdentitiesOnly yes

Host PRIVATE_LFS_REPO_DEPLOY_KEY.github.com
  HostName github.com
  IdentityFile C:\Users\runneradmin\.ssh\PRIVATE_LFS_REPO_DEPLOY_KEY
  IdentitiesOnly yes
â‹®
Cloning into 'private-repository-example'...
# An Example of Private Repository
â‹®
Cloning into 'private-lfs-repository-example'...
# An Example of Private Repository with LFS
Archive:  private-lfs-repository-example/empty.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2023-10-06 06:44 00000000  empty
--------          -------  ---                            -------
       0                0   0%                            1 file
</code></pre>
<blockquote>
<p><a href="attempt1/result-10.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>git config</code>ã®è¨­å®šå†…å®¹ã¨ã€<code>~/.ssh/config</code>ã®ä¸­èº«ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã€ãƒªãƒã‚¸ãƒˆãƒªBã¨Cã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ãŸã€‚æ­£ã—ããƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã§ãã¦ã„ã‚‹ã€‚</p>
<blockquote>
<p><span style="font-size: large;">â˜•</a></p>
<p>GitHubå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚â€œ<a href="https://docs.github.com/ja/authentication/connecting-to-github-with-ssh/managing-deploy-keys#using-multiple-repositories-on-one-server">1ã¤ã®ã‚µãƒ¼ãƒãƒ¼ä¸Šã§è¤‡æ•°ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆ©ç”¨ã™ã‚‹</a>â€ã§è¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æ‰±ã†åˆ¥ã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹ã€‚ã—ã‹ã—ã€ãã®æ–¹æ³•ã ã¨ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®<code>~/.ssh/config</code>ã‚‚å¤‰æ›´ã™ã‚‹ã“ã¨ã«ãªã‚‹ã—ã€<code>git clone</code>ã®éš›ã«ãƒªãƒã‚¸ãƒˆãƒªã®URLã¨ã—ã¦å½ã®URLã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚ã¾ãŸåˆ¥ã®é¢å€’ã‚’å¼•ãå¯„ã›ãŸããªã‘ã‚Œã°ã€é¿ã‘ãŸã»ã†ãŒè‰¯ã„ã€‚</p>
</blockquote>
<h2>webfactory/ssh-agentã§åˆ¥ã®è¤‡æ•°ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹</h2>
<p>ã—ã‹ã—ã€ã“ã®ã‚ˆã†ãªã€Œå·¥å¤«ã€ã‚’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã™ã‚‹ã®ã¯ç…©é›‘ã ã€‚åŒã˜ã“ã¨ã‚’ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®<a href="https://github.com/marketplace/actions/webfactory-ssh-agent">webfactory/ssh-agent</a>ã‚’æ¬¡ã®ã‚ˆã†ã«ä½¿ã£ã¦å®Ÿç¾ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    steps:
    - name: webfactory/ssh-agent
      uses: webfactory/ssh-agent@v0.8.0
      with:
        ssh-private-key: |
          ${{secrets.PRIVATE_REPO_DEPLOY_KEY}}
          ${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L241-L247">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Starting ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-QrHWdhFo8ceQ/agent.1095
SSH_AGENT_PID=1096
Adding private key(s) to agent
Identity added: (stdin) (git@github.com:maroontress-tomohisa/private-repository-example.git)
Identity added: (stdin) (git@github.com:maroontress-tomohisa/private-lfs-repository-example.git)
Key(s) added:
3072 SHA256:EHYsJhMvV2X03sbEYcAH3w7MNft1lra8M/ZSF0XMr5k git@github.com:maroontress-tomohisa/private-repository-example.git (RSA)
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
Configuring deployment key(s)
Added deploy-key mapping: Use identity 'C:\Users\runneradmin/.ssh/key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39' for GitHub repository maroontress-tomohisa/private-repository-example
Added deploy-key mapping: Use identity 'C:\Users\runneradmin/.ssh/key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9' for GitHub repository maroontress-tomohisa/private-lfs-repository-example
</code></pre>
<blockquote>
<p><a href="attempt1/result-11.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ç°¡å˜ã«ãªã£ãŸãŒã€å‰¯ä½œç”¨ã¨ã—ã¦<code>ssh-agent</code>ãŒãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§é–‹å§‹ã™ã‚‹ã€‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ç¢ºèªã—ã¦ã¿ã‚‹:</p>
<pre><code class="language-yaml">    - name: List fingerprints
      shell: bash
      run: ssh-add -l
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L248-L250">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">3072 SHA256:EHYsJhMvV2X03sbEYcAH3w7MNft1lra8M/ZSF0XMr5k git@github.com:maroontress-tomohisa/private-repository-example.git (RSA)
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
</code></pre>
<blockquote>
<p><a href="attempt1/result-12.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>git config</code>ã®è¨­å®šå†…å®¹ã¨ã€<code>~/.ssh/config</code>ã®ä¸­èº«ã‚‚ç¢ºèªã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Print git config
      shell: bash
      run: git config --global --list
    - name: Print ssh config
      shell: bash
      run: cat $HOME/.ssh/config
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L251-L256">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">url.git@key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39.github.com:maroontress-tomohisa/private-repository-example.insteadof=https://github.com/maroontress-tomohisa/private-repository-example
url.git@key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39.github.com:maroontress-tomohisa/private-repository-example.insteadof=git@github.com:maroontress-tomohisa/private-repository-example
url.git@key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39.github.com:maroontress-tomohisa/private-repository-example.insteadof=ssh://git@github.com/maroontress-tomohisa/private-repository-example
url.git@key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9.github.com:maroontress-tomohisa/private-lfs-repository-example.insteadof=https://github.com/maroontress-tomohisa/private-lfs-repository-example
url.git@key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9.github.com:maroontress-tomohisa/private-lfs-repository-example.insteadof=git@github.com:maroontress-tomohisa/private-lfs-repository-example
url.git@key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9.github.com:maroontress-tomohisa/private-lfs-repository-example.insteadof=ssh://git@github.com/maroontress-tomohisa/private-lfs-repository-example
â‹®

Host key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39.github.com
    HostName github.com
    IdentityFile C:\Users\runneradmin/.ssh/key-43749e3def49002289a25278b6d8d5a0b8fed7f2c33f26750fe6233c114a1c39
    IdentitiesOnly yes

Host key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9.github.com
    HostName github.com
    IdentityFile C:\Users\runneradmin/.ssh/key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9
    IdentitiesOnly yes
</code></pre>
<blockquote>
<p><a href="attempt1/result-13.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>git config</code>ã«é–¢ã—ã¦ã¯ã‚¨ãƒ³ãƒˆãƒªãŒå‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸‰å€ã«å¢—ãˆã¦ã„ã‚‹ãŒã€<code>git@github.com:</code>ã§å§‹ã‚ã‚‹SSHå½¢å¼ã®URLã«åŠ ãˆã¦ã€HTTPSå½¢å¼ã®URLã€<code>ssh://</code>ã§å§‹ã¾ã‚‹SSH+GITå½¢å¼ã®URLã‚‚å¤‰æ›ã®å¯¾è±¡ã«ãªã£ã¦ã„ã‚‹ã€‚ã‚ã¨ã¯ã€å½ãƒ›ã‚¹ãƒˆã®åå‰ã«ãƒãƒƒã‚·ãƒ¥å€¤ãŒä½¿ã‚ã‚Œã¦ã‚‹ã“ã¨ã‚’é™¤ã„ã¦ã€å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®èª¬æ˜ã¨é•ã„ã¯ç„¡ã„ã€‚</p>
<p>ã§ã¯ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Clone the private repository (which fails)
      shell: bash
      continue-on-error: true
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-repository-example.git
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L257-L261">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Cloning into 'private-repository-example'...
Host key verification failed.
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
Error: Process completed with exit code 128.
</code></pre>
<blockquote>
<p><a href="attempt1/result-14.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>webfactory/ssh-agentã®<a href="https://github.com/marketplace/actions/webfactory-ssh-agent#ssh-agent-github-action">èª¬æ˜</a>ã«ã‚ˆã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«<code>~/.ssh/known_hosts</code>ã‚’ç”Ÿæˆã™ã‚‹ã¨ã„ã†è¨˜è¿°ãŒã‚ã‚‹:</p>
<blockquote>
<p>This action</p>
<ul>
<li>â‹®</li>
<li>configures known_hosts for GitHub.com.</li>
</ul>
</blockquote>
<p>ã—ã‹ã—ã€Windowsãƒ©ãƒ³ãƒŠãƒ¼ã§ã¯ã©ã†ã‚„ã‚‰ã†ã¾ãã§ããªã„ã‚ˆã†ã ã€‚è‡ªåˆ†ã§ä½œæˆã—ã¦ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Perform workarounds
      shell: bash
      run: |
        mkdir -p $HOME/.ssh
        cat &lt;&lt; EOF &gt; $HOME/.ssh/known_hosts
        github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
        EOF
    - name: Clone a private repository
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-repository-example.git
        cat private-repository-example/README.md
    - name: Clone another private repository with LFS
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
        cat private-lfs-repository-example/README.md
        unzip -v private-lfs-repository-example/empty.zip
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L262-L279">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Cloning into 'private-repository-example'...
# An Example of Private Repository
â‹®
Cloning into 'private-lfs-repository-example'...
# An Example of Private Repository with LFS
Archive:  private-lfs-repository-example/empty.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2023-10-06 06:44 00000000  empty
--------          -------  ---                            -------
       0                0   0%                            1 file
</code></pre>
<blockquote>
<p><a href="attempt1/result-15.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>æˆåŠŸã—ãŸã€‚ãã—ã¦ã€ã‚„ã£ã¨æœ¬é¡Œã«å…¥ã‚Œã‚‹ã€‚</p>
<blockquote>
<p><span style="font-size: large;">ğŸš§</span></p>
<p>webfactory/ssh-agentã‚’æœ¬æ ¼çš„ã«ä½¿ç”¨ã™ã‚‹å ´åˆã€ãƒªãƒã‚¸ãƒˆãƒªã‚’ãã‚Œãã‚Œã®ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚³ãƒ”ãƒ¼ï¼ˆãƒ•ã‚©ãƒ¼ã‚¯ï¼‰ã—ã¦ã‹ã‚‰ä½¿ã†ã¹ãã§ã‚ã‚‹ã€‚æ”»æ’ƒè€…ãŒwebfactoryã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¹—ã£å–ã‚Šã€ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‚ªæ„ã‚’ã‚‚ã£ã¦æ›¸ãæ›ãˆã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã¨ãã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®URLã‚’æŠœã„ã¦ã—ã¾ã†ã€ã¨ã„ã†ãƒªã‚¹ã‚¯ã‚’æ’é™¤ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚ã“ã‚Œã¯webfactoryã«é™ã‚‰ãšã€GitHubå…¬å¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä»¥å¤–ã®å…¨ã¦ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£è£½ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å½“ã¦ã¯ã¾ã‚‹ã“ã¨ã ã€‚</p>
<p>å‚è€ƒã¾ã§ã«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã«ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã†è¨­å®šä¾‹ã‚’æ¬¡ã«ç¤ºã™:</p>
<div style="padding-left: 4em;">
<p><strong>ã‚³ãƒ”ãƒ¼ã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®è¨­å®š</strong></p>
<p><a href="attempt1/settings-actions-general.png">Settings âœ Actions âœ General</a> âœ Actions permissions ã§ â€œAllow <em>your-organization</em>, and select non-<em>your-organization</em>, actions and reusable workflowsâ€ ã‚’é¸æŠã—ã¦ä¿å­˜ã™ã‚‹ã€‚</p>
<img style="width: calc(100% - 16px); padding: 8px; background-color: #0e1017;" src="attempt1/security-hardening.png">
</div>
<p>ã“ã®ã‚ˆã†ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’è¨­å®šã™ã‚‹ã¨ã€è‡ªåˆ†ã®ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚³ãƒ”ãƒ¼ã—ãŸã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã€GitHubå…¬å¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®ã€Œverified creatorã€ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã ã‘ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã€‚ãã‚Œä»¥å¤–ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œæ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚</p>
<p>ã‚‚ã—ãã¯ã€è‡ªåˆ†ã®ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ä»£ã‚ã‚Šã«ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’SHA-1ãƒãƒƒã‚·ãƒ¥ã§æŒ‡å®šã—ã¦ã‚‚è‰¯ã„ã€‚ãŸã ã—ã€ãã®å ´åˆã§ã‚‚æ ¹æœ¬çš„ãªãƒ“ã‚¸ãƒã‚¹ã®ãƒªã‚¹ã‚¯ã¨ã—ã¦ã€ä¾å­˜ã—ã¦ã„ã‚‹å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒçªç„¶æ¶ˆå¤±ã™ã‚‹å¯èƒ½æ€§ï¼ˆä¾‹: é–‹ç™ºå…ƒã®ä½œæˆè€…ãŒãƒªãƒã‚¸ãƒˆãƒªã‚’æ¶ˆã—ã¦ã—ã¾ã†ã€ãªã©ï¼‰ã‚’èªè­˜ã—ã¦ãŠãã¹ãã§ã‚ã‚‹ã€‚ã•ã‚‰ã«ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªã‚³ãƒ”ãƒ¼ã«ã—ã‚SHA-1ãƒãƒƒã‚·ãƒ¥æŒ‡å®šã«ã—ã‚ã€ä½¿ã†ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒãã®ä¾å­˜é–¢ä¿‚ã«ã‚ˆã‚Šå‚ç…§ã™ã‚‹åˆ¥ã®ã€Œä½•ã‹ã€ãŒå•é¡Œã«ãªã‚‰ãªã„ã‹ã«ã¤ã„ã¦æ³¨æ„ã™ã‚‹å¿…è¦ã‚‚ã‚ã‚‹ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã«é–¢ã™ã‚‹è©³ç´°ã¯ã€å…¬å¼ã®ã€Œ<a href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-third-party-actions"><em>Using third-party actions</em> â€” Security hardening for GitHub Actions</a>ã€ã‚’å‚ç…§ã€‚</p>
</blockquote>
<h2>æ··ãœã‚‹ãªå±é™º</h2>
<p>æœ€å¾Œã«ã€ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®actions/checkoutã¨webfactory/ssh-agentã‚’çµ„ã¿åˆã‚ã›ã¦ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ã¦ã¿ã‚ˆã†ã€‚æœ€åˆã«ã€webfactory/ssh-agentã§ãƒªãƒã‚¸ãƒˆãƒªCã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ãŸã‚ã®æº–å‚™ã¨ã—ã¦ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æ¬¡ã®ã‚ˆã†ã«ç™»éŒ²ã™ã‚‹:</p>
<pre><code class="language-yaml">    steps:
    - name: webfactory/ssh-agent
      uses: webfactory/ssh-agent@v0.8.0
      with:
        ssh-private-key: |
          ${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}
    â‹®
    - name: Perform workarounds
      shell: bash
      run: |
        mkdir -p $HOME/.ssh
        cat &lt;&lt; EOF &gt; $HOME/.ssh/known_hosts
        github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
        EOF
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L285-L306">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Starting ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-bGHWNwHc6WoG/agent.1649
SSH_AGENT_PID=1650
Adding private key(s) to agent
Identity added: (stdin) (git@github.com:maroontress-tomohisa/private-lfs-repository-example.git)
Key(s) added:
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
Configuring deployment key(s)
Added deploy-key mapping: Use identity 'C:\Users\runneradmin/.ssh/key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9' for GitHub repository maroontress-tomohisa/private-lfs-repository-example
â‹®
</code></pre>
<blockquote>
<p><a href="attempt1/result-16.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ã‚ã¨ã¯ãƒªãƒã‚¸ãƒˆãƒªCã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ã ã‘ã ãŒã€ãã®å‰ã«actions/checkoutã§ãƒªãƒã‚¸ãƒˆãƒªBã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹:</p>
<pre><code class="language-yaml">    - name: Checkout a private repository with actions/checkout
      uses: actions/checkout@v4
      with:
        repository: maroontress-tomohisa/private-repository-example
        ssh-key: ${{secrets.PRIVATE_REPO_DEPLOY_KEY}}
        path: private-repository
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L311-L316">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Syncing repository: maroontress-tomohisa/private-repository-example
Getting Git version info
Copying 'C:\Users\runneradmin\.gitconfig' to 'D:\a\_temp\d52f99d9-b40f-4405-a929-b1a18384d9db\.gitconfig'
Temporarily overriding HOME='D:\a\_temp\d52f99d9-b40f-4405-a929-b1a18384d9db' before making global git config changes
Adding repository directory to the temporary git global config as a safe directory
&quot;C:\Program Files\Git\bin\git.exe&quot; config --global --add safe.directory D:\a\try_out_github_actions\try_out_github_actions\private-repository
Initializing the repository
Disabling automatic garbage collection
Setting up auth
Determining the default branch
Fetching the repository
Determining the checkout info
Checking out the ref
&quot;C:\Program Files\Git\bin\git.exe&quot; log -1 --format='%H'
'3cf9492e7ffb20ea5246a8edf1bec8d3aab293a4'
</code></pre>
<blockquote>
<p><a href="attempt1/result-17.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>æˆåŠŸã—ãŸã€‚ç¶šã„ã¦ã€ãƒªãƒã‚¸ãƒˆãƒªCã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: List fingerprints after actions/checkout (which fails)
      continue-on-error: true
      shell: bash
      run: ssh-add -l
    - name: Clone another private repository with LFS (which fails)
      continue-on-error: true
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
        cat private-lfs-repository-example/README.md
        unzip -v private-lfs-repository-example/empty.zip
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L317-L327">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>æœ¬æ¥ã¯ä¸è¦ã ãŒã€<code>git clone</code>ã®å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯<code>ssh-add</code>ã‚’ç”¨ã„ã¦<code>ssh-agent</code>ã®çŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã€‚çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">Error connecting to agent: Bad file descriptor
Error: Process completed with exit code 2.
â‹®
Cloning into 'private-lfs-repository-example'...
Load key &quot;C:\\Users\\runneradmin/.ssh/key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9&quot;: error in libcrypto
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
Error: Process completed with exit code 128.
</code></pre>
<blockquote>
<p><a href="attempt1/result-18.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>git clone</code>ã¯å¤±æ•—ã—ãŸã€‚ãã®å‰ã®<code>git-add -l</code>ã‚‚å¤±æ•—ã—ã¦ã„ã‚‹ã€‚actions/checkoutã‚’å®Ÿè¡Œã—ãŸçµæœã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œä¸­ã®<code>ssh-agent</code>ã®çŠ¶æ…‹ãŒå£Šã‚ŒãŸï¼ˆãƒ—ãƒ­ã‚»ã‚¹ã¯å­˜åœ¨ã—ã¦ã„ã‚‹ãŒã€ãƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡ã®ã‚¹ãƒ†ãƒ¼ãƒˆãŒãŠã‹ã—ããªã£ãŸï¼‰ã®ã ã‚ã†ã€‚</p>
<p>ã¨ã‚Šã‚ãˆãšã€æ¬¡ã®ã‚ˆã†ã«<code>ssh-agent</code>ã‚’å†èµ·å‹•ã—ã¦ã‹ã‚‰ã€å†åº¦ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã¿ã‚ˆã†:</p>
<pre><code class="language-yaml">    - name: Perform more workarounds (kill ssh-agent to restart)
      shell: bash
      run: |
        eval `ssh-agent -k`
        # The following lines are placebos (because we can't unset env.*):
        echo SSH_AUTH_SOCK= &gt;&gt; &quot;$GITHUB_ENV&quot;
        echo SSH_AGENT_PID= &gt;&gt; &quot;$GITHUB_ENV&quot;
        # See https://github.com/actions/runner/issues/1126
    - name: webfactory/ssh-agent
      uses: webfactory/ssh-agent@v0.8.0
      with:
        ssh-private-key: |
          ${{secrets.PRIVATE_LFS_REPO_DEPLOY_KEY}}
    - name: List fingerprints (after restarting ssh-agent)
      shell: bash
      run: ssh-add -l
    - name: Clone another private repository with LFS
      shell: bash
      run: |
        git clone --depth 1 git@github.com:maroontress-tomohisa/private-lfs-repository-example.git
        cat private-lfs-repository-example/README.md
        unzip -v private-lfs-repository-example/empty.zip
</code></pre>
<blockquote>
<p><a href="https://github.com/maroontress/try_out_github_actions/blob/34978a2a8ae8e8ff696b696263402560da53f977/.github/workflows/windows-ssh-agent.yml#L329-L350">GitHubã§è¦‹ã‚‹</a></p>
</blockquote>
<p>çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ãŸ:</p>
<pre><code class="language-plaintext">unset SSH_AUTH_SOCK;
unset SSH_AGENT_PID;
echo Agent pid 1650 killed;
â‹®
Starting ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-nR7bVfNdAwqI/agent.766
SSH_AGENT_PID=767
Adding private key(s) to agent
Identity added: (stdin) (git@github.com:maroontress-tomohisa/private-lfs-repository-example.git)
Key(s) added:
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
Configuring deployment key(s)
Added deploy-key mapping: Use identity 'C:\Users\runneradmin/.ssh/key-aabbaf196b10644a69c23360df933575c9e9d496cfc251dabf9b22ee13d7bea9' for GitHub repository maroontress-tomohisa/private-lfs-repository-example
â‹®
3072 SHA256:61EFfTJR56r9rX3u9EGG/HrvPcejWJTR0VLssfIpBzg git@github.com:maroontress-tomohisa/private-lfs-repository-example.git (RSA)
â‹®
Cloning into 'private-lfs-repository-example'...
# An Example of Private Repository with LFS
Archive:  private-lfs-repository-example/empty.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2023-10-06 06:44 00000000  empty
--------          -------  ---                            -------
       0                0   0%                            1 file
</code></pre>
<blockquote>
<p><a href="attempt1/result-19.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p><code>ssh-agent</code>ã‚’å†èµ·å‹•ã™ã‚‹ã¨ã€ç¢ºã‹ã«å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ã¯æ¶ˆãˆãŸã€‚ã•ã¦ã€ãªãœã“ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ãã‚‹ã®ã‹èª¿ã¹ã¦ã¿ã‚ˆã†ã€‚</p>
<p>actions/checkoutãŒä½•æ•…èµ·å‹•æ¸ˆã¿ã®<code>ssh-agent</code>ã‚’ã€Œå£Šã™ã€ã®ã ã‚ã†ã‹ã€‚actions/checkoutã®ãƒ­ã‚°ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€æ¬¡ã®è¡Œã«æ°—ã¥ã:</p>
<pre><code class="language-plaintext">â–¾Setting up auth
  â‹®
  &quot;C:\Program Files\Git\bin\git.exe&quot; config --local core.sshCommand &quot;\&quot;C:\Windows\System32\OpenSSH\ssh.exe\&quot; -i \&quot;$RUNNER_TEMP/455b31bf-8bfa-4d87-bb2e-3d92b700ba9a\&quot; -o StrictHostKeyChecking=yes -o CheckHostIP=no -o \&quot;UserKnownHostsFile=$RUNNER_TEMP/455b31bf-8bfa-4d87-bb2e-3d92b700ba9a_known_hosts\&quot;&quot;
</code></pre>
<blockquote>
<p><a href="attempt1/result-20.png">GitHub Actionsã®çµæœ</a></p>
</blockquote>
<p>ãªã‚“ã¨ã€actions/checkoutã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æŒ‡å®šã—ãŸå ´åˆã€SSHã«<code>C:\<wbr>Windows\<wbr>System32\<wbr>OpenSSH\<wbr>ssh.exe</code>ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã ã€‚Windowsã«ã¯<code>ssh</code>ã®å®Ÿè£…ãŒã„ãã¤ã‹ã‚ã‚‹ãŒã€OpenSSHç‰ˆã®å®Ÿè£…ã¨Git for Windowsç‰ˆã®å®Ÿè£…ã¯äº’æ›æ€§ãŒç„¡ã„ã€‚OpenSSHã®<code>ssh</code>ã¨Git for Windowsã®<code>ssh-agent</code>ã‚’ä¸€ç·’ã«ä½¿ã†ã“ã¨ã¯ã§ããªã„ã€‚äº’æ›æ€§ãŒç„¡ã„ç†ç”±ã¯ã¡ã‚ƒã‚“ã¨èª¿ã¹ã¦ãªã„ãŒã€ãŠãã‚‰ããƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡ã§ä½¿ã†ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒé•ã†ã®ã ã‚ã†ï¼ˆã ã¨ã™ã‚‹ã¨ã€ä½•æ•…åŒã˜ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã ã‚ã†? ã‚ˆãçµŒç·¯ã¯ã‚ã‹ã‚‰ãªã„ãŒã€ã¾ã¨ã‚‚ã§ã¯ãªã„ã“ã¨ã¯é–“é•ã„ãªã„ï¼‰ã€‚</p>
<p>ã¾ã¨ã‚ã‚‹ã¨ã€Windowsãƒ©ãƒ³ãƒŠãƒ¼ã®å ´åˆ:</p>
<ul>
<li><code>bash</code>ã‹ã‚‰<code>ssh-agent</code>ã‚’èµ·å‹•ã™ã‚‹ã¨ã€Git for Windowsã®å®Ÿè£…ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ä½œã™ã‚‹ï¼ˆã‚ˆã†ã«ç’°å¢ƒå¤‰æ•°<code>PATH</code>ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼‰ã€‚</li>
<li>actions/checkoutã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã¨ã€<code>git</code>ãŒSSHã®å®Ÿè£…ã¨ã—ã¦<code>C:\<wbr>Windows\<wbr>System32\<wbr>OpenSSH\<wbr>ssh.exe</code>ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚</li>
<li>OpenSSHã®<code>ssh.exe</code>ã¯ç’°å¢ƒå¤‰æ•°<code>SSH_AUTH_SOCK</code>ã¨<code>SSH_AGENT_PID</code>ã®å€¤ã‚’è¦‹ã¦ã€OpenSSHç‰ˆ<code>ssh-agent</code>ãŒå®Ÿè¡Œä¸­ã¨åˆ¤æ–­ã—ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡ã‚’é–‹å§‹ã™ã‚‹ã€‚ã—ã‹ã—ã€èµ·å‹•ã—ã¦ã„ã‚‹ã®ã¯Git for Windowsç‰ˆã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãªã®ã§ã€çŠ¶æ…‹ãŒå£Šã‚Œã‚‹ï¼ˆå¤šåˆ†ï¼‰ã€‚</li>
</ul>
<p>æ¬¡ã®ã‚ˆã†ãªå›é¿æ–¹æ³•ãŒã‚ã‚‹:</p>
<ul>
<li>å…ˆã«actions/checkoutã€ãã®å¾Œã«<code>ssh-agent</code>ï¼ˆã¾ãŸã¯webfactory/ssh-agentï¼‰ã¨ã„ã†é †ç•ªã«ãªã‚‹ã‚ˆã†ã«å¾¹åº•ã™ã‚‹ã€‚</li>
<li><code>ssh-agent</code>ã¯OpenSSHç‰ˆï¼ˆ<code>C:\<wbr>Windows\<wbr>System32\<wbr>OpenSSH\<wbr>ssh-agent.exe</code>ï¼‰ã‚’ä½¿ã†ã€‚</li>
<li>è¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’ä½¿ã†ã ã‘ãªã‚‰ã€<code>ssh-agent</code>ã‚’èµ·å‹•ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚</li>
</ul>
<p>æœ€åˆã®äºŒã¤ã®é¸æŠè‚¢ã¯ã€åˆ¥ã®æ··ä¹±ã‚’æ‹›ãå¯èƒ½æ€§ãŒé«˜ã„ã®ã§ã€ã‚„ã‚ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã€‚ãã‚‚ãã‚‚ã€webfactory/ssh-agentã¯ã€ãã®åå‰ãŒè¡¨ã™ã‚ˆã†ã«ã€<code>ssh-agent</code>ã‚’ä½¿ã†ãŸã‚ã®ã‚‚ã®ã ã€‚ã ã‹ã‚‰ã€è¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æ‰±ã†ãŸã‚ã ã‘ã«ä½¿ã†ã®ã¯æ‚ªç”¨ãªã®ã§ã¯ãªã„ã ã‚ã†ã‹ã€‚ãƒ‘ãƒƒã¨æ¢ã—ãŸã ã‘ã ã¨ã€ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã«ã¯è¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’æ‰±ã†ã ã‘ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã€‚ã ã¨ã™ã‚‹ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è‡ªä½œï¼ˆã—ã¦ã€å…¬é–‹ï¼‰ã™ã‚‹ã®ã‚‚è‰¯ã•ãã†ã ã€‚</p>
<footer>
<!-- Created: Tue Dec  5 21:40:30 JST 2023 -->
<!-- hhmts start -->
<!-- hhmts end -->
</footer>
          </main>
        </section>
      </div>
      <div class="left-container">
<nav>
  <div>
    <a href="/">Projects</a>
  </div>
  <div>
    <span>&#x25BE;</span>
  </div>
  <div>
    <span class="project-name"><a href="index.html">GitHub Actions and Dungeons</a></span>
  </div>
  <ul>
    <li>
      <a href="index.html">Top</a>
    </li>
    <li class="selected">
      Attemp #1 Windowsãƒ©ãƒ³ãƒŠãƒ¼ã§ssh-agent
    </li>
    <ul id="toc-placeholder">
    </ul>
    <li>
      <a href="runner-image-versions.html">Attemp #2 ä¸¦åˆ—ãƒ“ãƒ«ãƒ‰ã¨ãƒ©ãƒ³ãƒŠãƒ¼ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³</a>
    </li>
  </ul>
</nav>
      </div>
    </div>
  </body>
</html>
